<script>
  if (navigator.geolocation) {
    var geolocation = new qq.maps.Geolocation("OZBBZ-ZQLC3-MKF3U-3VCU4-DFWO7-AGFPB", "weather_survey")
    geolocation.getLocation( (r) => {
      lat=r.lat;
      lon=r.lng;
      location.href = "../weather_forecast?lon="+lon+"&lat="+lat;
    })
  }else {
    alert("Geolocation is not supported by this browser.");
  }

  function showPosition(position) {
    lat=position.coords.latitude;
    lon=position.coords.longitude;
    location.href = "../weather_forecast?lon="+lon+"&lat="+lat;
  }

  function showError(error) {
    switch(error.code) {
      case error.PERMISSION_DENIED:
        alert("User denied the request for Geolocation.");
        break;
      case error.POSITION_UNAVAILABLE:
        alert("Location information is unavailable.");
        break;
      case error.TIMEOUT:
        alert("The request to get user location timed out.");
        break;
      case error.UNKNOWN_ERROR:
        alert("An unknown error occurred.");
        break;
    }
  }
</script>
