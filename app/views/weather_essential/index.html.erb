<% content_for :title do %>
  气象要素
<% end %>
<div class="row top-container">
  <%= render 'share/topper' %>
</div>
<div class="row bottom-container">
  <%= render 'bottom_bar' %>
  <div class="help_btn">
    <div id="help_btn">帮助</div>
  </div>
  <div class="row tab-content main-content">
    <div role="tabpanel" class="tab-pane main-pane col-xs-12 active" id="tempe">
      <table id="tempe-table" class="table table-hover table-striped table-condensed table-fixed-header" role="grid">
        <thead class="header">
          <td>&nbsp&nbsp站名&nbsp&nbsp</td>
          <td>即时气温 <span class="glyphicon glyphicon-sort"></span></td>
          <td>今日最低 <span class="glyphicon glyphicon-sort"></span></td>
          <td>今日最高 <span class="glyphicon glyphicon-sort"></span></td>
          <!-- <td>离你距离 <span class="glyphicon glyphicon-sort"></span></td> -->
        </thead>
        <tbody>
          <% @statistics.each do |item| %>
            <% if item['name'].eql? '松江' %>
            <tr class="main-station" data="tempe_<%= item['sitenumber'] %>">
            <% elsif item['name'].eql? @real_time_site['name'] %>
            <tr data="tempe_<%= item['sitenumber'] %>" class="tr-station">
            <% else %>
            <tr data="tempe_<%= item['sitenumber'] %>">
            <% end %>
              <td><%= item['name'] %></td>
              <td class="<%= tempe_color item['tempe'] %>"><%= filter(item['tempe']) %></td>
              <td class="<%= tempe_color item['min_tempe'] %>"><%= item['min_tempe'] %></td>
              <td class="<%= tempe_color item['max_tempe'] %>"><%= item['max_tempe'] %></td>
              <!-- <td><%#= item['distance'] %></td> -->
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
    <div role="tabpanel" class="tab-pane main-pane col-xs-12" id="wind">
      <table class="table table-hover table-striped table-condensed table-fixed-header">
        <thead class="header">
          <tr class="more_word">
            <td>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp站名&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp </td>
            <td>1小时最大 <span class="glyphicon glyphicon-sort"></span></td>
            <td>3小时最大 <span class="glyphicon glyphicon-sort"></span></td>
            <td>6小时最大 <span class="glyphicon glyphicon-sort"></span></td>
            <td>24小时最大 <span class="glyphicon glyphicon-sort"></span></td>
          </tr>
        </thead>
        <tbody>
          <% @statistics.each do |item| %>
            <% if item['name'].eql? '松江' %>
            <tr class="main-station" data="wind_<%= item['sitenumber'] %>">
            <% else %>
            <tr data="wind_<%= item['sitenumber'] %>">
            <% end %>
              <td><%= item['name'] %></td>
              <td>
                <%= item['one_hour_speed'] %>
                <% one_level = speed_to_level item['one_hour_speed'] %>
                <span class="wind_level <%= wind_color one_level %>">
                  <%= one_level %>
                </span>
              </td>
              <td>
                <%= item['three_hour_speed'] %>
                <% three_level = speed_to_level item['three_hour_speed'] %>
                <span class="wind_level <%= wind_color three_level %>">
                  <%= three_level %>
                </span>
              </td>
              <td>
                <%= item['six_hour_speed'] %>
                <% six_level = speed_to_level item['six_hour_speed'] %>
                <span class="wind_level <%= wind_color six_level %>">
                  <%= six_level %>
                </span>
              </td>
              <td>
                <%= item['one_day_speed'] %>
                <% day_level = speed_to_level item['one_day_speed'] %>
                <span class="wind_level <%= wind_color day_level %>">
                  <%= day_level %>
                </span>
              </td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
    <div role="tabpanel" class="tab-pane main-pane col-xs-12" id="rain">
      <table class="table table-hover table-striped table-condensed table-fixed-header">
        <thead class="header">
          <tr>
            <td>&nbsp&nbsp&nbsp&nbsp&nbsp站名&nbsp&nbsp&nbsp&nbsp&nbsp</td>
            <td>1小时 <span class="glyphicon glyphicon-sort"></span></td>
            <td>3小时 <span class="glyphicon glyphicon-sort"></span></td>
            <td>6小时 <span class="glyphicon glyphicon-sort"></span></td>
            <td>24小时 <span class="glyphicon glyphicon-sort"></span></td>
          </tr>
        </thead>
        <tbody>
          <% @statistics.each do |item| %>
            <% if item['name'].eql? '松江' %>
            <tr class="main-station" data="rain_<%= item['sitenumber'] %>">
            <% else %>
            <tr data="rain_<%= item['sitenumber'] %>">
            <% end %>
              <td><%= item['name'] %></td>
              <td class="<%= "text-danger" if item['one_hour_rain'].to_i >= 20 %>"><%= item['one_hour_rain'] %></td>
              <td><%= item['three_hour_rain'] %></td>
              <td><%= item['six_hour_rain'] %></td>
              <td class="<%= "text-danger" if item['one_day1_rain'].to_i >= 50 %>"><%= item['one_day1_rain'] %></td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
    <div role="tabpanel" class="tab-pane main-pane col-xs-12" id="city">
      <%= render 'city' %>
    </div>
  </div>
</div>
<div id="typhoon_list_d_c" class="active_list typhoon_list_d_c">
  <div class="typhoon_list_d table-responsive">
    <div class="title">温度统计相关说明</div>
    <div>即刻温度:最新统计时间的温度值</div>
    <div>今日最低气温:气象局统计中以每天的20时为日界,今日最低气温为上一日的20:01~最新统计时间的最低气温</div>
    <div>今日最高气温:气象局统计中以每天的20时为日界,今日最高气温为上一日的20:01~最新统计时间的最高气温</div><br>
    <div>附:松江区域自动站表</div>
    <table class="table table-condensed table-bordered ">
      <tr>
        <th>序号</th>
        <th>站名</th>
        <th>站点地址</th>
      </tr>
      <tr>
        <th>1</th>
        <th>华实中学</th>
        <th>南青路8号</th>
      </tr>
      <tr>
        <th>2</th>
        <th>小昆山</th>
        <th>小昆山镇荡湾村曹浜路408号</th>
      </tr>
      <tr>
        <th>3</th>
        <th>叶榭</th>
        <th>叶榭镇政府</th>
      </tr>
      <tr>
        <th>4</th>
        <th>新桥</th>
        <th>新桥镇新闵小学</th>
      </tr>
      <tr>
        <th>5</th>
        <th>车墩</th>
        <th>车亭公路128号</th>
      </tr>
      <tr>
        <th>6</th>
        <th>新浜</th>
        <th>新浜镇甪彭路1888号</th>
      </tr>
      <tr>
        <th>7</th>
        <th>石湖荡</th>
        <th>石湖荡镇闵塔公路李塔渔庄</th>
      </tr>
      <tr>
        <th>8</th>
        <th>泗泾</th>
        <th>泗泾镇叶家公路101号</th>
      </tr>
      <tr>
        <th>9</th>
        <th>五库</th>
        <th>五库农展馆</th>
      </tr>
      <tr>
        <th>10</th>
        <th>九亭</th>
        <th>九亭气象园</th>
      </tr>
      <tr>
        <th>11</th>
        <th>天马山</th>
        <th>九江路近沈砖公路</th>
      </tr>
      <tr>
        <th>12</th>
        <th>浦南花卉叶新公路近松金公路</th>
        <th>新浜镇甪彭路1888号</th>
      </tr>
      <tr>
        <th>13</th>
        <th>西部渔村</th>
        <th>昆泖公路西到底</th>
      </tr>
      <tr>
        <th>14</th>
        <th>泖港</th>
        <th>叶新公路999号</th>
      </tr>
      <tr>
        <th>15</th>
        <th>佘山顶</th>
        <th>西佘山天文台楼顶</th>
      </tr>
      <tr>
        <th>16</th>
        <th>洞泾</th>
        <th>洞泾镇丁仙园</th>
      </tr>
      <tr>
        <th>17</th>
        <th>永丰街道</th>
        <th>富永路近黄浦江</th>
      </tr>
      <tr>
        <th>18</th>
        <th>第一中学</th>
        <th>松汇路人民路</th>
      </tr>
      <tr>
        <th>19</th>
        <th>工业区</th>
        <th>江田东路200号</th>
      </tr>
      <tr>
        <th>20</th>
        <th>泰晤士</th>
        <th>泰晤士华庭胡边</th>
      </tr>
      <tr>
        <th>21</th>
        <th>荣乐路</th>
        <th>荣乐路九峰路口</th>
      </tr>
      <tr>
        <th>22</th>
        <th>农业中心</th>
        <th>松金公路9969号</th>
      </tr>
    </table>
  </div>
  <div id="triangle-down"></div>
</div>
<div id="typhoon_list_d_c1" class="active_list typhoon_list_d_c">
  <div class="typhoon_list_d table-responsive">
    <div class="title">风级、风速对照表</div>
    <div>1小时最大风速：当前小时内，01分至统计时间内的最大风速值；</div>
    <div>3小时最大风速：过去3小时内的最大风速值（如当前时间为9:25，3小时最大风速为6：01~9：00时段内的最大风速值）;</div>
    <div>6小时最大风速：过去6小时内的最大风速值（如当前时间为9:25，6小时最大风速为3：01~9：00时段内的最大风速值）;</div>
    <div>24小时最大风速：过去24小时内的最大风速值（如当前时间为2日9:25，24小时最大风速为1日9：01~2日9：00时段内的最大风速值）;</div><br>
    <div>附：风级、风速对照表</div>
    <table class="table table-condensed table-bordered ">
      <tr>
        <th rowspan="2">风级</th>
        <th rowspan="2">名称</th>
        <th colspan="3">相当于空旷平地上标准高度（10米）处的风速</th>
      </tr>
      <tr>
        <td>米/秒</td>
        <td>海里/小时</td>
        <td>公里/小时</td>
      </tr>
      <tr>
        <td>0</td>
        <td>静风</td>
        <td>0-0.2</td>
        <td><1</td>
        <td><1</td>
      </tr>
      <tr>
        <td>1</td>
        <td>软风</td>
        <td>0.3-1.5</td>
        <td>1-3</td>
        <td>1-5</td>
      </tr>
      <tr>
        <td>2</td>
        <td>轻风</td>
        <td>1.6-3.3</td>
        <td>4-6</td>
        <td>6-11</td>
      </tr>
      <tr>
        <td>3</td>
        <td>微风</td>
        <td>3.4-5.4</td>
        <td>7-10</td>
        <td>12-19</td>
      </tr>
      <tr>
        <td>4</td>
        <td>和风</td>
        <td>5.5-7.9</td>
        <td>11-16</td>
        <td>20-28</td>
      </tr>
      <tr>
        <td>5</td>
        <td>清劲风</td>
        <td>8.0-10.7</td>
        <td>17-21</td>
        <td>29-38</td>
      </tr>
      <tr>
        <td>6</td>
        <td>强风</td>
        <td>10.8-13.8</td>
        <td>22-27</td>
        <td>39-49</td>
      </tr>
      <tr>
        <td>7</td>
        <td>疾风</td>
        <td>13.9-17.1</td>
        <td>28-33</td>
        <td>50-61</td>
      </tr>
      <tr>
        <td>8</td>
        <td>大风</td>
        <td>17.2-20.7</td>
        <td>34-40</td>
        <td>62-74</td>
      </tr>
      <tr>
        <td>9</td>
        <td>烈风</td>
        <td>20.8-24.4</td>
        <td>41-47</td>
        <td>75-88</td>
      </tr>
      <tr>
        <td>10</td>
        <td>狂风</td>
        <td>24.5-28.4</td>
        <td>48-55</td>
        <td>89-102</td>
      </tr>
      <tr>
        <td>11</td>
        <td>暴风</td>
        <td>28.5-32.6</td>
        <td>56-63</td>
        <td>103-117</td>
      </tr>
      <tr>
        <td>12</td>
        <td>飓风</td>
        <td>32.7-36.9</td>
        <td>64-71</td>
        <td>118-133</td>
      </tr>
      <tr>
        <td>13</td>
        <td></td>
        <td>37.0-41.4</td>
        <td>72-80</td>
        <td>134-149</td>
      </tr>
      <tr>
        <td>14</td>
        <td></td>
        <td>41.5-46.1</td>
        <td>81-89</td>
        <td>150-166</td>
      </tr>
      <tr>
        <td>15</td>
        <td></td>
        <td>46.2-50.9</td>
        <td>90-99</td>
        <td>167-183</td>
      </tr>
      <tr>
        <td>16</td>
        <td></td>
        <td>51.0-56.0</td>
        <td>100-108</td>
        <td>184-201</td>
      </tr>
      <tr>
        <td>17</td>
        <td></td>
        <td>56.1-61.2</td>
        <td>109-118</td>
        <td>202-220</td>
      </tr>
      <tr>
        <td>18</td>
        <td></td>
        <td>≥61.3</td>
        <td>≥119</td>
        <td>≥221</td>
      </tr>
    </table>
  </div>
  <div id="triangle-down"></div>
</div>
<div id="typhoon_list_d_c2" class="active_list typhoon_list_d_c">
  <div class="typhoon_list_d table-responsive">
    <div class="title">雨量</div>
    <div>即时雨量：当前小时内，01分至当前分钟的雨量累计值（如当前时间为9:25，即时雨量为9:01~9:25的累计值）；</div>
    <div>3小时累计雨量：过去3小时雨量累计值（如当前时间为9:25，3小时雨量为7、8、9时3个正点雨量的累计值）；</div>
    <div>12小时累计雨量：过去12小时雨量累计值（如当前时间为2日9:25，12小时雨量为1日22时~2日9时12个正点雨量的累计值）；</div>
    <div>24小时累计雨量：过去24小时雨量累计值（如当前时间为2日9:25，24小时雨量为1日10时~2日9时24个正点雨量的累计值）。</div><br>
    <table class="table table-condensed table-bordered ">
      <tr>
        <th>降水等级</th>
        <th>12小时标准(mm)</th>
        <th>24小时标准(mm)</th>
      </tr>
      <tr>
        <td>小雨</td>
        <td>0.1-4.9</td>
        <td>0.1-9.9</td>
      </tr>
      <tr>
        <td>小到中雨</td>
        <td>3.0-9.9</td>
        <td>5.0-16.9</td>
      </tr>
      <tr>
        <td>中雨</td>
        <td>5.0-14.9</td>
        <td>10.0-24.9</td>
      </tr>
      <tr>
        <td>中到大雨</td>
        <td>10.0-22.9</td>
        <td>17.0-37.9</td>
      </tr>
      <tr>
        <td>大雨</td>
        <td>15.0-29.9</td>
        <td>25.0-49.9</td>
      </tr>
      <tr>
        <td>大到暴雨</td>
        <td>23.0-49.9</td>
        <td>38.0-74.9</td>
      </tr>
      <tr>
        <td>暴雨</td>
        <td>30.0-69.9</td>
        <td>50.0-99.9</td>
      </tr>
      <tr>
        <td>暴雨到大暴雨</td>
        <td>50.0-104.9</td>
        <td>75.0-174.9</td>
      </tr>
      <tr>
        <td>大暴雨</td>
        <td>70.0-140.0</td>
        <td>100.0-250.0</td>
      </tr>
      <tr>
        <td>大暴雨到特大暴雨</td>
        <td>105.0-170.0</td>
        <td>175.0-300.0</td>
      </tr>
      <tr>
        <td>特大暴雨</td>
        <td>>140.0</td>
        <td>>250.0</td>
      </tr>
      <tr>
        <td colspan="3">&nbsp</td>
      </tr>
      <tr>
        <td>小雪</td>
        <td>0.1-0.9</td>
        <td>0.1-2.4</td>
      </tr>
      <tr>
        <td>小到中雪</td>
        <td>0.5-1.9</td>
        <td>1.3-3.7</td>
      </tr>
      <tr>
        <td>中雪</td>
        <td>1.0-2.9</td>
        <td>2.5-4.9</td>
      </tr>
      <tr>
        <td>中到大雪</td>
        <td>2.0-4.4</td>
        <td>3.8-7.4</td>
      </tr>
      <tr>
        <td>大雪</td>
        <td>3.0-5.9</td>
        <td>5.0-9.9</td>
      </tr>
      <tr>
        <td>大到暴雪</td>
        <td>4.5-7.5</td>
        <td>7.5-15.0</td>
      </tr>
      <tr>
        <td>暴雪</td>
        <td>≥6.0</td>
        <td>小≥10.0</td>
      </tr>
    </table>
  </div>
  <div id="triangle-down"></div>
</div>
<div id="typhoon_list_d_c3" class="active_list typhoon_list_d_c">
  <div class="typhoon_list_d table-responsive">
    <div class="title">全市实况</div>
    <div>全市实况包含全市68个国家级区域自动站监测的温度、雨量和风，11个国家级观测站的气压、能见度和相对湿度。</div>
  </div>
  <div id="triangle-down"></div>
</div>
<div id="float-window">
  <div class="header"><span class='target-name'></span><i class="pull-right iconfont icon-guanbi"></i></div>
</div>
<div id="myChart">    
</div>
<div id="barChart">
</div>
<script type="text/javascript">
  
  function change_tab(target) {
    if (target == null) {
      $('ul.tab').children('a').each(function(index, el) {
        if ($(el).attr('aria-controls') == _page) {
          $(el).find('li').addClass('active');
        } else {
          $(target).find('li').removeClass('active');    
        }
      });
    } else {
      $('ul.tab').children('a').each(function(index, el) {
        if (el == target) {
          $(el).find('li').css({'color': '#88cc42'});
        } else {
          $(el).find('li').css({'color': '#fff'});
        }
      });
    }
  }

  var type = "tempe"
  $('.tab-bar').on('click', 'a', function(){
    type = $(this).attr('aria-controls');
    if (type == "tempe") {
      $("#typhoon_list_d_c1").addClass('active_list');
      $("#typhoon_list_d_c2").addClass('active_list');
      $("#typhoon_list_d_c3").addClass('active_list');
    }else if (type == "wind"){
      $("#typhoon_list_d_c").addClass('active_list');
      $("#typhoon_list_d_c2").addClass('active_list');
      $("#typhoon_list_d_c3").addClass('active_list');
    }else if (type == "rain"){
      $("#typhoon_list_d_c").addClass('active_list');
      $("#typhoon_list_d_c1").addClass('active_list');
      $("#typhoon_list_d_c3").addClass('active_list');
    } else if (type == "city"){
      $("#typhoon_list_d_c").addClass('active_list');
      $("#typhoon_list_d_c2").addClass('active_list');
      $("#typhoon_list_d_c1").addClass('active_list');
    }
    return type
  });

  // 帮助图例
  $("#help_btn").on('click', function() {
    if (type == "tempe") {
      if ($('#typhoon_list_d_c').hasClass('active_list')) {
        $("#typhoon_list_d_c").removeClass('active_list');
        $("#typhoon_list_d_c").addClass('hide_list');
        return;
      }
      $("#typhoon_list_d_c").removeClass('hide_list');
      $("#typhoon_list_d_c").addClass('active_list');
    }else if (type == "wind"){
      if ($('#typhoon_list_d_c1').hasClass('active_list')) {
        $("#typhoon_list_d_c1").removeClass('active_list');
        $("#typhoon_list_d_c1").addClass('hide_list');
        return;
      }
      $("#typhoon_list_d_c1").removeClass('hide_list');
      $("#typhoon_list_d_c1").addClass('active_list');
    }else if (type == "rain"){
      if ($('#typhoon_list_d_c2').hasClass('active_list')) {
        $("#typhoon_list_d_c2").removeClass('active_list');
        $("#typhoon_list_d_c2").addClass('hide_list');
        return;
      }
      $("#typhoon_list_d_c2").removeClass('hide_list');
      $("#typhoon_list_d_c2").addClass('active_list');
    } else if (type == "city"){
      if ($('#typhoon_list_d_c3').hasClass('active_list')) {
        $("#typhoon_list_d_c3").removeClass('active_list');
        $("#typhoon_list_d_c3").addClass('hide_list');
        return;
      }
      $("#typhoon_list_d_c3").removeClass('hide_list');
      $("#typhoon_list_d_c3").addClass('active_list');
    }
  });

  $(function(){
    var w_height = $(document).height();
    var table_height = w_height - 200;
    $('table').dataTable({
      "searching": false,
      "paging": false,
      "scrollY": table_height,
      "scrollX": true,
      "scrollCollapse": true,
      "info": false,
      "fixedColumns": {
        "leftColumns": 1
      }
    });
  });

  var myChart = null;
  var barChart = null;
  var chart_type = 'line';

  require.config({
    paths: {echarts: '/assets/echarts'}
  });

  require(
    ['echarts','echarts/chart/line'],
    function (ec) {
      $('#myChart').each(function(){
        myChart = ec.init($(this).get(0));
        option = {
          title: {text: "24小时趋势图", textStyle: {color: '#fff'}, x: 'center', y: 10},
          legend: {show: false, data: []},
          grid: {x: 30, y: 50, x2: 10, y2: 30, borderWidth: 0},
          tooltip: {show: true, trigger: 'axis', formatter: "时间: {b}<br/>{a} : {c}"},
          xAxis: [
            {
              type: 'category',
              axisLabel: {textStyle: {color: '#fff'}},
              splitLine: {show: false},
              data: [0,0,0,0,0,0,0,0,0,0,0,0]
            }
          ],
          yAxis: [{
            type: 'value', splitLine: {show: false}, 
            axisLabel: {textStyle: {color: '#fff'}},
            scale: true
          }],
          series: [
            {
              type: 'line', x: '10%', showAllSymbol: true,
              data: [0,0,0,0,0,0,0,0,0,0,0,0]
            }
          ]
        };

        myChart.setOption(option);
      });
    }
  );

  require(
    ['echarts','echarts/chart/bar'],
    function (ec) {
      $('#barChart').each(function(){
        barChart = ec.init($(this).get(0));
        bar_option = {
          title: {text: "24小时趋势图", textStyle: {color: '#fff'}, x: 'center', y: 10},
          legend: {show: false, data: []},
          grid: {x: 30, y: 50, x2: 10, y2: 30, borderWidth: 0},
          tooltip: {show: true, trigger: 'axis', formatter: "时间: {b}<br/>{a} : {c}"},
          xAxis: [
            {
              type: 'category',
              axisLabel: {textStyle: {color: '#fff'}},
              splitLine: {show: false},
              data: [0,0,0,0,0,0,0,0,0,0,0,0]
            }
          ],
          yAxis: [{
            type: 'value', splitLine: {show: false}, 
            axisLabel: {textStyle: {color: '#fff'}},
            scale: true
          }],
          series: [
            {
              type: 'bar', x: '10%', showAllSymbol: true,
              data: [0,0,0,0,0,0,0,0,0,0,0,0]
            }
          ]
        };

        barChart.setOption(bar_option);
      });
    }
  );

  var _top_container_height = $('.top-container').height();
  $(".bottom-container").css({
    top: _top_container_height + 14
  });

  $(".header").css({
    top: _top_container_height + 14
  });

  $("#myChart").hide();
  $("#barChart").hide();

  $("tbody").on('click', 'tr', function(e){
    var _target = $(this).attr('data');
    var _type = _target.split('_')[0];
    var _site = _target.split('_')[1];
    // 改变选中样式
    $("tr").removeClass("tr-active");
    $(this).addClass("tr-active");
    // 加载数据
    get_data(_type, _site);
    $("#float-window").show();
  });

  $("#float-window .iconfont").click(function(e) {
    hide_float_window();
  });

  function hide_float_window() {
    $("#myChart").hide();
    $("#barChart").hide();
    $("#float-window").hide();
  }

  $('.tab-bar').on('click', 'a', function(){
    var type = $(this).attr('aria-controls');
    if (type == 'rain') {
      chart_type = 'bar';
    }else{
      chart_type = 'line';
    }
    change_tab(this);
    hide_float_window();
  });

  function get_data(type, site) {
    $.ajax({
      type: 'get',
      url: '/auto_stations/history',
      headers: {Accept: 'application/json'},
      data: {type: type, sitenumber: site},
      success: function(json) {
        show_chart(json.result);
      },
      fail: function(json) {
        console.log(json);
      }
    });
  }

  function show_chart(data) {
    var _datas = [];
    var _times = [];
    var _type;
    $.each(data, function(i, item){
      if (_type == undefined) {
        _type = item.type  
      }
      _times.push(item.datetime);
      _datas.push(item.data);
    });
    if (_type == '降水') {
      barChart.setOption({
        title: {text: '24小时' + _type + '趋势图'},
        legend: {data: [_type]},
        xAxis: [{data: _times}],
        series: [{name: _type, data: _datas}]
      });  
      $("#barChart").show();
      $("#myChart").hide();
    } else {
      myChart.setOption({
        title: {text: '24小时' + _type + '趋势图'},
        legend: {data: [_type]},
        xAxis: [{data: _times}],
        series: [{name: _type, data: _datas}]
      });  
      $("#barChart").hide();
      $("#myChart").show();
    }
  }

  <!-- // 设置排序图标 -->
  $(function() {
    $(".header td").click(function() {
      var _td_class = $(this).attr("class");
      // 重置class
      $(".header td").children("span").removeClass("glyphicon-triangle-bottom glyphicon-triangle-top");
      $(".header td").children("span").addClass("glyphicon-sort");
      // 隐藏图表
      hide_float_window();
      // 设置点击的class
      if (_td_class == "sorting_asc") {
        $(this).children("span").removeClass("glyphicon-sort glyphicon-triangle-bottom");
        $(this).children("span").addClass("glyphicon-triangle-top");
      } else if (_td_class == "sorting_desc") {
        $(this).children("span").removeClass("glyphicon-sort glyphicon-triangle-top");
        $(this).children("span").addClass("glyphicon-triangle-bottom");
      } 
    });
  })

</script>
